(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{Exa6:function(o,e,t){"use strict";t.r(e),t.d(e,"AdminModule",(function(){return D}));var r=t("ofXK"),n=t("3Pt+"),i=t("6XRw"),s=t("tyNb"),b=t("fXoL"),a=t("9O1O");class c{static isbnFormat(o){if(!o.value)return null;const e=o.value.replace(/-/g,"");return/(^\d{10}$)|(^\d{13}$)/.test(e)?null:{isbnFormat:{valid:!1}}}static atLeastOneAuthor(o){return o.controls.some(o=>o.value)?null:{atLeastOneAuthor:{valid:!1}}}}var l=t("LRne"),u=t("lJxs"),m=t("JIr8");let d=(()=>{class o{constructor(o){this.bs=o}validate(o){return this.bs.check(o.value).pipe(Object(u.a)(o=>!1===o?null:{isbnExists:{valid:!1}}),Object(m.a)(()=>Object(l.a)(null)))}}return o.\u0275fac=function(e){return new(e||o)(b.Ub(a.a))},o.\u0275prov=b.Fb({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function h(o,e){if(1&o&&(b.Ob(0,"div",1),b.pc(1),b.Nb()),2&o){const o=e.$implicit;b.zb(1),b.rc(" ",o,"\n")}}let f=(()=>{class o{constructor(){this.allMessages={title:{required:"Ein Buchtitel muss angegeben werden."},isbn:{required:"Es muss eine ISBN angegeben werden.",isbnFormat:"Die ISBN muss aus 10 oder 13 Zeichen bestehen.",isbnExists:"Die ISBN existiert bereits."},published:{required:"Es muss ein Erscheinungsdatum angegeben werden."},authors:{atLeastOneAuthor:"Es muss ein Autor angegeben werden."}}}ngOnInit(){}errorsForControl(){const o=this.allMessages[this.controlName];return this.control&&this.control.errors&&o&&this.control.dirty?Object.keys(this.control.errors).map(e=>o[e]):null}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=b.Db({type:o,selectors:[["bm-form-messages"]],inputs:{control:"control",controlName:"controlName"},decls:1,vars:1,consts:[["class","ui negative message",4,"ngFor","ngForOf"],[1,"ui","negative","message"]],template:function(o,e){1&o&&b.nc(0,h,2,1,"div",0),2&o&&b.ec("ngForOf",e.errorsForControl())},directives:[r.j],styles:[""]}),o})();var p,k,g,F,N,O,v,B,C,y;p="Book Title",k="Subtitle",g="ISBN Number",F="Published Date",N="Authors",O="+ Author",v="Description",B="Thumbnails",C="+ Thumbnail",y="Save";const z=["placeholder","Author"];function w(o,e){if(1&o&&(b.Ob(0,"div",16),b.Ob(1,"input",17),b.Tb(2,z),b.Nb(),b.Nb()),2&o){const o=e.index;b.zb(1),b.ec("formControlName",o)}}const A=["placeholder","http://example_Url"],S=["placeholder","Book Title"];function $(o,e){1&o&&(b.Ob(0,"div",18),b.Ob(1,"div",19),b.Ob(2,"input",20),b.Tb(3,A),b.Nb(),b.Nb(),b.Ob(4,"div",21),b.Ob(5,"input",22),b.Tb(6,S),b.Nb(),b.Nb(),b.Nb()),2&o&&b.ec("formGroupName",e.index)}let j=(()=>{class o{constructor(o,e){this.fb=o,this.bookExistsValidator=e,this.editing=!1,this.submitBook=new b.n}ngOnInit(){this.initForm()}ngOnChanges(){this.initForm(),this.setFormValues(this.book)}setFormValues(o){this.bookForm.patchValue(o),this.bookForm.setControl("authors",this.buildAuthorsArray(o.authors)),this.bookForm.setControl("thumbnails",this.buildThumbnailsArray(o.thumbnails))}initForm(){this.bookForm||(this.bookForm=this.fb.group({title:["",n.q.required],subtitle:[""],isbn:[{value:"",disabled:this.editing},[n.q.required,c.isbnFormat],this.editing?null:[this.bookExistsValidator]],description:[""],authors:this.buildAuthorsArray([""]),thumbnails:this.buildThumbnailsArray([{title:"",url:""}]),published:[]}))}buildAuthorsArray(o){return this.fb.array(o,c.atLeastOneAuthor)}buildThumbnailsArray(o){return this.fb.array(o.map(o=>this.fb.group(o)))}get authors(){return this.bookForm.get("authors")}get thumbnails(){return this.bookForm.get("thumbnails")}addAuthorControl(){this.authors.push(this.fb.control(""))}addThumbnailControl(){this.thumbnails.push(this.fb.group({url:"",title:""}))}submitForm(){const o=this.bookForm.value,e=o.authors.filter(o=>o),t=o.thumbnails.filter(o=>o.url),r=this.editing?this.book.isbn:o.isbn,n=Object.assign(Object.assign({},o),{isbn:r,authors:e,thumbnails:t});this.submitBook.emit(n),this.bookForm.reset()}}return o.\u0275fac=function(e){return new(e||o)(b.Jb(n.c),b.Jb(d))},o.\u0275cmp=b.Db({type:o,selectors:[["bm-book-form"]],inputs:{book:"book",editing:"editing"},outputs:{submitBook:"submitBook"},features:[b.xb],decls:34,vars:8,consts:[[1,"ui","form",3,"formGroup","ngSubmit"],["formControlName","title"],["controlName","title",3,"control"],["formControlName","subtitle"],["formControlName","isbn"],["controlName","isbn",3,"control"],["type","date","useValueAsDate","","formControlName","published"],["controlName","published",3,"control"],["type","button",1,"ui","mini","button",3,"click"],["formArrayName","authors",1,"fields"],["class","sixteen wide field",4,"ngFor","ngForOf"],["controlName","authors",3,"control"],["formControlName","description"],["formArrayName","thumbnails"],["class","fields",3,"formGroupName",4,"ngFor","ngForOf"],["type","submit",1,"ui","button",3,"disabled"],[1,"sixteen","wide","field"],[3,"formControlName",6,"placeholder"],[1,"fields",3,"formGroupName"],[1,"nine","wide","field"],["formControlName","url",6,"placeholder"],[1,"seven","wide","field"],["formControlName","title",6,"placeholder"]],template:function(o,e){1&o&&(b.Ob(0,"form",0),b.Yb("ngSubmit",(function(){return e.submitForm()})),b.Ob(1,"label"),b.Sb(2,p),b.Nb(),b.Kb(3,"input",1),b.Kb(4,"bm-form-messages",2),b.Ob(5,"label"),b.Sb(6,k),b.Nb(),b.Kb(7,"input",3),b.Ob(8,"label"),b.Sb(9,g),b.Nb(),b.Kb(10,"input",4),b.Kb(11,"bm-form-messages",5),b.Ob(12,"label"),b.Sb(13,F),b.Nb(),b.Kb(14,"input",6),b.Kb(15,"bm-form-messages",7),b.Ob(16,"label"),b.Sb(17,N),b.Nb(),b.Ob(18,"button",8),b.Yb("click",(function(){return e.addAuthorControl()})),b.Sb(19,O),b.Nb(),b.Ob(20,"div",9),b.nc(21,w,3,1,"div",10),b.Nb(),b.Kb(22,"bm-form-messages",11),b.Ob(23,"label"),b.Sb(24,v),b.Nb(),b.Kb(25,"textarea",12),b.Ob(26,"label"),b.Sb(27,B),b.Nb(),b.Ob(28,"button",8),b.Yb("click",(function(){return e.addThumbnailControl()})),b.Sb(29,C),b.Nb(),b.Ob(30,"div",13),b.nc(31,$,7,1,"div",14),b.Nb(),b.Ob(32,"button",15),b.Sb(33,y),b.Nb(),b.Nb()),2&o&&(b.ec("formGroup",e.bookForm),b.zb(4),b.ec("control",e.bookForm.get("title")),b.zb(7),b.ec("control",e.bookForm.get("isbn")),b.zb(4),b.ec("control",e.bookForm.get("published")),b.zb(6),b.ec("ngForOf",e.authors.controls),b.zb(1),b.ec("control",e.bookForm.get("authors")),b.zb(9),b.ec("ngForOf",e.thumbnails.controls),b.zb(1),b.ec("disabled",e.bookForm.invalid))},directives:[n.r,n.l,n.e,n.a,n.k,n.d,f,i.a,n.b,r.j,n.f],styles:[""]}),o})();var x;x="Book Form";let I=(()=>{class o{constructor(o,e,t){this.bs=o,this.route=e,this.router=t}ngOnInit(){}createBook(o){this.bs.create(o).subscribe(()=>{this.router.navigate(["../..","books"],{relativeTo:this.route})})}}return o.\u0275fac=function(e){return new(e||o)(b.Jb(a.a),b.Jb(s.a),b.Jb(s.d))},o.\u0275cmp=b.Db({type:o,selectors:[["bm-create-book"]],decls:3,vars:0,consts:[[3,"submitBook"]],template:function(o,e){1&o&&(b.Ob(0,"h1"),b.Sb(1,x),b.Nb(),b.Ob(2,"bm-book-form",0),b.Yb("submitBook",(function(o){return e.createBook(o)})),b.Nb())},directives:[j],styles:[""]}),o})();var J,T=t("eIep");function E(o,e){if(1&o){const o=b.Pb();b.Ob(0,"bm-book-form",1),b.Yb("submitBook",(function(e){return b.jc(o),b.ac().updateBook(e)})),b.Nb()}if(2&o){const o=b.ac();b.ec("book",o.book)("editing",!0)}}J="Book Form";const K=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:I},{path:"edit/:isbn",component:(()=>{class o{constructor(o,e,t){this.bs=o,this.route=e,this.router=t}ngOnInit(){this.route.paramMap.pipe(Object(u.a)(o=>o.get("isbn")),Object(T.a)(o=>this.bs.getSingle(o))).subscribe(o=>this.book=o)}updateBook(o){this.bs.update(o).subscribe(()=>{this.router.navigate(["../../..","books",o.isbn],{relativeTo:this.route})})}}return o.\u0275fac=function(e){return new(e||o)(b.Jb(a.a),b.Jb(s.a),b.Jb(s.d))},o.\u0275cmp=b.Db({type:o,selectors:[["bm-edit-book"]],decls:3,vars:1,consts:[[3,"book","editing","submitBook",4,"ngIf"],[3,"book","editing","submitBook"]],template:function(o,e){1&o&&(b.Ob(0,"h1"),b.Sb(1,J),b.Nb(),b.nc(2,E,1,2,"bm-book-form",0)),2&o&&(b.zb(2),b.ec("ngIf",e.book))},directives:[r.k,j],styles:[""]}),o})()}];let q=(()=>{class o{}return o.\u0275mod=b.Hb({type:o}),o.\u0275inj=b.Gb({factory:function(e){return new(e||o)},providers:[],imports:[[s.h.forChild(K)],s.h]}),o})(),D=(()=>{class o{}return o.\u0275mod=b.Hb({type:o}),o.\u0275inj=b.Gb({factory:function(e){return new(e||o)},imports:[[r.c,q,n.o,i.b]]}),o})()}}]);