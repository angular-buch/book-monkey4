(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{Exa6:function(o,t,e){"use strict";e.r(t),e.d(t,"AdminModule",(function(){return T}));var r=e("ofXK"),b=e("3Pt+"),i=e("6XRw"),n=e("tyNb"),s=e("fXoL"),a=e("9O1O");class c{static isbnFormat(o){if(!o.value)return null;const t=o.value.replace(/-/g,"");return/(^\d{10}$)|(^\d{13}$)/.test(t)?null:{isbnFormat:{valid:!1}}}static atLeastOneAuthor(o){return o.controls.some(o=>o.value)?null:{atLeastOneAuthor:{valid:!1}}}}var l=e("LRne"),u=e("lJxs"),m=e("JIr8");let d=(()=>{class o{constructor(o){this.bs=o}validate(o){return this.bs.check(o.value).pipe(Object(u.a)(o=>!1===o?null:{isbnExists:{valid:!1}}),Object(m.a)(()=>Object(l.a)(null)))}}return o.\u0275fac=function(t){return new(t||o)(s.Sb(a.a))},o.\u0275prov=s.Db({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function h(o,t){if(1&o&&(s.Mb(0,"div",1),s.mc(1),s.Lb()),2&o){const o=t.$implicit;s.xb(1),s.oc(" ",o,"\n")}}let f=(()=>{class o{constructor(){this.allMessages={title:{required:"Ein Buchtitel muss angegeben werden."},isbn:{required:"Es muss eine ISBN angegeben werden.",isbnFormat:"Die ISBN muss aus 10 oder 13 Zeichen bestehen.",isbnExists:"Die ISBN existiert bereits."},published:{required:"Es muss ein Erscheinungsdatum angegeben werden."},authors:{atLeastOneAuthor:"Es muss ein Autor angegeben werden."}}}ngOnInit(){}errorsForControl(){const o=this.allMessages[this.controlName];return this.control&&this.control.errors&&o&&this.control.dirty?Object.keys(this.control.errors).map(t=>o[t]):null}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=s.Bb({type:o,selectors:[["bm-form-messages"]],inputs:{control:"control",controlName:"controlName"},decls:1,vars:1,consts:[["class","ui negative message",4,"ngFor","ngForOf"],[1,"ui","negative","message"]],template:function(o,t){1&o&&s.kc(0,h,2,1,"div",0),2&o&&s.bc("ngForOf",t.errorsForControl())},directives:[r.j],styles:[""]}),o})();var p,k,g,F,v,B,C,L,M,y;p="Book Title",k="Subtitle",g="ISBN Number",F="Published Date",v="Authors",B="+ Author",C="Description",L="Thumbnails",M="+ Thumbnail",y="Save";const N=["placeholder","Author"];function O(o,t){if(1&o&&(s.Mb(0,"div",16),s.Mb(1,"input",17),s.Rb(2,N),s.Lb(),s.Lb()),2&o){const o=t.index;s.xb(1),s.bc("formControlName",o)}}const w=["placeholder","http://example_Url"],A=["placeholder","Book Title"];function x(o,t){1&o&&(s.Mb(0,"div",18),s.Mb(1,"div",19),s.Mb(2,"input",20),s.Rb(3,w),s.Lb(),s.Lb(),s.Mb(4,"div",21),s.Mb(5,"input",22),s.Rb(6,A),s.Lb(),s.Lb(),s.Lb()),2&o&&s.bc("formGroupName",t.index)}let I=(()=>{class o{constructor(o,t){this.fb=o,this.bookExistsValidator=t,this.editing=!1,this.submitBook=new s.n}ngOnInit(){this.initForm()}ngOnChanges(){this.initForm(),this.setFormValues(this.book)}setFormValues(o){this.bookForm.patchValue(o),this.bookForm.setControl("authors",this.buildAuthorsArray(o.authors)),this.bookForm.setControl("thumbnails",this.buildThumbnailsArray(o.thumbnails))}initForm(){this.bookForm||(this.bookForm=this.fb.group({title:["",b.q.required],subtitle:[""],isbn:[{value:"",disabled:this.editing},[b.q.required,c.isbnFormat],this.editing?null:[this.bookExistsValidator]],description:[""],authors:this.buildAuthorsArray([""]),thumbnails:this.buildThumbnailsArray([{title:"",url:""}]),published:[]}))}buildAuthorsArray(o){return this.fb.array(o,c.atLeastOneAuthor)}buildThumbnailsArray(o){return this.fb.array(o.map(o=>this.fb.group(o)))}get authors(){return this.bookForm.get("authors")}get thumbnails(){return this.bookForm.get("thumbnails")}addAuthorControl(){this.authors.push(this.fb.control(""))}addThumbnailControl(){this.thumbnails.push(this.fb.group({url:"",title:""}))}submitForm(){const o=this.bookForm.value,t=o.authors.filter(o=>o),e=o.thumbnails.filter(o=>o.url),r=this.editing?this.book.isbn:o.isbn,b=Object.assign(Object.assign({},o),{isbn:r,authors:t,thumbnails:e});this.submitBook.emit(b),this.bookForm.reset()}}return o.\u0275fac=function(t){return new(t||o)(s.Hb(b.c),s.Hb(d))},o.\u0275cmp=s.Bb({type:o,selectors:[["bm-book-form"]],inputs:{book:"book",editing:"editing"},outputs:{submitBook:"submitBook"},features:[s.vb],decls:34,vars:8,consts:[[1,"ui","form",3,"formGroup","ngSubmit"],["formControlName","title"],["controlName","title",3,"control"],["formControlName","subtitle"],["formControlName","isbn"],["controlName","isbn",3,"control"],["type","date","useValueAsDate","","formControlName","published"],["controlName","published",3,"control"],["type","button",1,"ui","mini","button",3,"click"],["formArrayName","authors",1,"fields"],["class","sixteen wide field",4,"ngFor","ngForOf"],["controlName","authors",3,"control"],["formControlName","description"],["formArrayName","thumbnails"],["class","fields",3,"formGroupName",4,"ngFor","ngForOf"],["type","submit",1,"ui","button",3,"disabled"],[1,"sixteen","wide","field"],[3,"formControlName",6,"placeholder"],[1,"fields",3,"formGroupName"],[1,"nine","wide","field"],["formControlName","url",6,"placeholder"],[1,"seven","wide","field"],["formControlName","title",6,"placeholder"]],template:function(o,t){1&o&&(s.Mb(0,"form",0),s.Vb("ngSubmit",(function(){return t.submitForm()})),s.Mb(1,"label"),s.Qb(2,p),s.Lb(),s.Ib(3,"input",1),s.Ib(4,"bm-form-messages",2),s.Mb(5,"label"),s.Qb(6,k),s.Lb(),s.Ib(7,"input",3),s.Mb(8,"label"),s.Qb(9,g),s.Lb(),s.Ib(10,"input",4),s.Ib(11,"bm-form-messages",5),s.Mb(12,"label"),s.Qb(13,F),s.Lb(),s.Ib(14,"input",6),s.Ib(15,"bm-form-messages",7),s.Mb(16,"label"),s.Qb(17,v),s.Lb(),s.Mb(18,"button",8),s.Vb("click",(function(){return t.addAuthorControl()})),s.Qb(19,B),s.Lb(),s.Mb(20,"div",9),s.kc(21,O,3,1,"div",10),s.Lb(),s.Ib(22,"bm-form-messages",11),s.Mb(23,"label"),s.Qb(24,C),s.Lb(),s.Ib(25,"textarea",12),s.Mb(26,"label"),s.Qb(27,L),s.Lb(),s.Mb(28,"button",8),s.Vb("click",(function(){return t.addThumbnailControl()})),s.Qb(29,M),s.Lb(),s.Mb(30,"div",13),s.kc(31,x,7,1,"div",14),s.Lb(),s.Mb(32,"button",15),s.Qb(33,y),s.Lb(),s.Lb()),2&o&&(s.bc("formGroup",t.bookForm),s.xb(4),s.bc("control",t.bookForm.get("title")),s.xb(7),s.bc("control",t.bookForm.get("isbn")),s.xb(4),s.bc("control",t.bookForm.get("published")),s.xb(6),s.bc("ngForOf",t.authors.controls),s.xb(1),s.bc("control",t.bookForm.get("authors")),s.xb(9),s.bc("ngForOf",t.thumbnails.controls),s.xb(1),s.bc("disabled",t.bookForm.invalid))},directives:[b.r,b.l,b.e,b.a,b.k,b.d,f,i.a,b.b,r.j,b.f],styles:[""]}),o})();var $;$="Book Form";let z=(()=>{class o{constructor(o,t,e){this.bs=o,this.route=t,this.router=e}ngOnInit(){}createBook(o){this.bs.create(o).subscribe(()=>{this.router.navigate(["../..","books"],{relativeTo:this.route})})}}return o.\u0275fac=function(t){return new(t||o)(s.Hb(a.a),s.Hb(n.a),s.Hb(n.d))},o.\u0275cmp=s.Bb({type:o,selectors:[["bm-create-book"]],decls:3,vars:0,consts:[[3,"submitBook"]],template:function(o,t){1&o&&(s.Mb(0,"h1"),s.Qb(1,$),s.Lb(),s.Mb(2,"bm-book-form",0),s.Vb("submitBook",(function(o){return t.createBook(o)})),s.Lb())},directives:[I],styles:[""]}),o})();var E,j=e("eIep");function Q(o,t){if(1&o){const o=s.Nb();s.Mb(0,"bm-book-form",1),s.Vb("submitBook",(function(t){return s.gc(o),s.Xb().updateBook(t)})),s.Lb()}if(2&o){const o=s.Xb();s.bc("book",o.book)("editing",!0)}}E="Book Form";const V=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:z},{path:"edit/:isbn",component:(()=>{class o{constructor(o,t,e){this.bs=o,this.route=t,this.router=e}ngOnInit(){this.route.paramMap.pipe(Object(u.a)(o=>o.get("isbn")),Object(j.a)(o=>this.bs.getSingle(o))).subscribe(o=>this.book=o)}updateBook(o){this.bs.update(o).subscribe(()=>{this.router.navigate(["../../..","books",o.isbn],{relativeTo:this.route})})}}return o.\u0275fac=function(t){return new(t||o)(s.Hb(a.a),s.Hb(n.a),s.Hb(n.d))},o.\u0275cmp=s.Bb({type:o,selectors:[["bm-edit-book"]],decls:3,vars:1,consts:[[3,"book","editing","submitBook",4,"ngIf"],[3,"book","editing","submitBook"]],template:function(o,t){1&o&&(s.Mb(0,"h1"),s.Qb(1,E),s.Lb(),s.kc(2,Q,1,2,"bm-book-form",0)),2&o&&(s.xb(2),s.bc("ngIf",t.book))},directives:[r.k,I],styles:[""]}),o})()}];let S=(()=>{class o{}return o.\u0275mod=s.Fb({type:o}),o.\u0275inj=s.Eb({factory:function(t){return new(t||o)},providers:[],imports:[[n.h.forChild(V)],n.h]}),o})(),T=(()=>{class o{}return o.\u0275mod=s.Fb({type:o}),o.\u0275inj=s.Eb({factory:function(t){return new(t||o)},imports:[[r.c,S,b.o,i.b]]}),o})()}}]);